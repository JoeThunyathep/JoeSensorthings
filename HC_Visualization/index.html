<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Use correct character set. -->
    <meta charset="utf-8">
    <!-- Tell IE to use the latest, best version (or Chrome Frame if pre-IE11). -->
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <!-- Make the application on mobile take up the full browser screen and disable user scaling. -->
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no">

    <title>STA Demo</title>

    <!-- Uncomment for add the script from the HTTP source  -->
    <!-- <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.9.2/jquery-ui.min.js"></script> 
    <link href='http://code.jquery.com/ui/1.9.2/themes/base/jquery-ui.css' rel='stylesheet' type='text/css' />
    <link href='http://fonts.googleapis.com/css?family=Lato:400,700' rel='stylesheet' type='text/css'>-->

    <!-- add the JQuery locally -->
    <script src="./code/jquery-ui/js/jquery-1.8.3.js"></script>
    <script src="./code/jquery-ui/js/jquery-ui-1.9.2.custom.min.js"></script>
    <link href='./code/jquery-ui/css/ui-darkness/jquery-ui-1.9.2.custom.css' rel='stylesheet' type='text/css' />
    <link href='./code/LatoCSS.css' rel='stylesheet' type='text/css'>
    <!-- add the Highchart source locally -->
    <script src="./code/hc/highcharts.js"></script>
    <script src="./code/hc/modules/series-label.js"></script>
    <script src="./code/hc/modules/exporting.js"></script>
    <script src="./code/hc/js/themes/dark-unica.js"></script>
    <script src="./code/jstat.min.js"></script>
</head>

<body>
    <div> Select the STA-Datastream </div>
    <div class="nowrap" id="CesiumStyleChoice">
        <select id="Datastream Selection">
            <option value="op1"> Out-Temperature Aula </option>
            <option value="op2"> option 2 </option>
            <option value="op3"> option 3 </option>
        </select>
    </div>
    <div class="nowrap" id="SelectDate">
        Select the Date
        <br>
        <input type="text" id="dateSelector" style='width:80px'>
        <br>
        <button id="submitDate">Confirm</button>
        <button id="submitAggregation">Aggregation Processing</button>
    </div>
    <div class="nowrap" id="aggregationOut">
        Mean : 
        <span id="Mean_Val"></span><br>
        SD :
        <span id="SD_Val"></span>
    </div>

    <div class="backdrop" id="HightChartContainer" draggable="true">
    </div>

    <script>
        var dateSelected, selectedYearStr, selectedMonthStr, selectedDateStr;
        $(document).ready(function () {
            //var Defdate = new Date('2017-11-22');
            $("#dateSelector").datepicker({
                minDate: new Date(2015, 12, 1),
                maxDate: "+12D",
                changeMonth: true,
                changeYear: true,
                yearRange: '2016:2017',
            });
            $("#dateSelector").datepicker("option", "dateFormat", "yy-mm-dd");
            $("#dateSelector").datepicker("option", "showAnim", "slideDown");
            //$("#dateSelector").datepicker({ minDate: 0, maxDate: "+12D" });
            $("#dateSelector").datepicker().datepicker("setDate", new Date('2015-12-1'));

            //jquery for Time selector from ...
            //Add From - To Time for drawing Highchart
            $("#submitDate").click(function () {
                dateSelected = $("#dateSelector").val();
                if (dateSelected === "") {
                    alert("Please select date.");
                } else {
                    selectedYearStr = dateSelected.split("-")[0] * 1;
                    selectedMonthStr = dateSelected.split("-")[1] * 1;
                    selectedDateStr = dateSelected.split("-")[2] * 1;
                    // Request for the data from STA server
                    var requestedData = GenSerieData(selectedDateStr, selectedDateStr + 1, selectedMonthStr);
                    // GenSerieData (Date From, Date To, Month)
                    setTimeout(function cb() {
                        drawChart(requestedData[0], selectedDateStr, selectedMonthStr, selectedYearStr);
                    }, 500);
                    // Timeout is needed to wait for the font of
                }
            });
            // not done yet!!!!
            $("#submitAggregation").click(function () {
                dateSelected = $("#dateSelector").val();
                if (dateSelected === "") {
                    alert("Please select date.");
                } else {
                    selectedYearStr = dateSelected.split("-")[0] * 1;
                    selectedMonthStr = dateSelected.split("-")[1] * 1;
                    selectedDateStr = dateSelected.split("-")[2] * 1;
                    // Request for the data from STA server
                    var requestedData = GenSerieData(selectedDateStr, selectedDateStr + 1, selectedMonthStr);
                    // GenSerieData (Date From, Date To, Month)
                    setTimeout(function cb() {
                        console.log("Processing Aggregation using JStat.js ...");
                        document.getElementById('Mean_Val').innerHTML = jStat.mean(requestedData[1]).toFixed(3) + " Celsius";
                        document.getElementById('SD_Val').innerHTML = jStat.stdev(requestedData[1]).toFixed(3) + " Celsius";
                    }, 500);
                    // Timeout is needed to wait for the font of
                }
            });
        });
    </script>
    <script src="DrawHighchart.js"></script>
</body>

</html>